@page "/classdetails/{ClassName}"
@using global::MarkMe.Models
@inject AttendanceService AttendanceService
@inject NavigationManager Navigation
@rendermode InteractiveServer

<h3 class="mb-4">
    <i class="bi bi-info-circle me-2"></i>Class Details: <span class="text-info">@ClassName</span>
</h3>

@if (info != null)
{
    <div class="card shadow-sm p-4 bg-dark text-light border-secondary">
        <div class="mb-3">
            <label class="form-label fw-bold">
                <i class="bi bi-person-badge me-2"></i>Teacher
            </label>
            <input class="form-control bg-secondary text-light border-0" @bind="info.Teacher" />
        </div>

        <div class="mb-3">
            <label class="form-label fw-bold">
                <i class="bi bi-person-workspace me-2"></i>Co-Teacher
            </label>
            <input class="form-control bg-secondary text-light border-0" @bind="info.CoTeacher" />
        </div>

        <div class="mb-3">
            <label class="form-label fw-bold">
                <i class="bi bi-card-text me-2"></i>Description
            </label>
            <textarea class="form-control bg-secondary text-light border-0" rows="4" @bind="info.Description"></textarea>
        </div>

        <div class="d-flex gap-2">
            <button class="btn btn-primary" @onclick="Save">
                <i class="bi bi-save me-1"></i>Save
            </button>
            <button class="btn btn-secondary" @onclick="Back">
                <i class="bi bi-arrow-left-circle me-1"></i>Back
            </button>
        </div>
    </div>
}
else
{
    <div class="alert alert-info">
        <i class="bi bi-hourglass-split me-2"></i>Loading class details...
    </div>
}

@code {
    [Parameter] public string ClassName { get; set; } = "";
    private ClassTeacherInfo? info;

    protected override void OnInitialized()
    {
        info = AttendanceService.GetTeacherInfo(ClassName);
    }

    private void Save()
    {
        if (info == null) return;
        AttendanceService.SaveTeacherInfo(info);
        Navigation.NavigateTo("/manageclasses");
    }

    private void Back() => Navigation.NavigateTo("/manageclasses");
}
